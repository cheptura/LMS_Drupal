# Monitoring Installation Scripts

## –û–ø–∏—Å–∞–Ω–∏–µ
–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ —Å–∏—Å—Ç–µ–º—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ RTTI —Å Prometheus, Grafana –∏ Alertmanager –Ω–∞ Ubuntu 24.04 LTS.

## üöÄ QUICK_INSTALL
```bash
# –ë—ã—Å—Ç—Ä–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ (–æ–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π)
git clone https://github.com/cheptura/LMS_Drupal.git
cd LMS_Drupal/monitoring-installation
sudo chmod +x install-monitoring.sh && sudo ./install-monitoring.sh
```

## –°–æ—Å—Ç–∞–≤ —Å–∫—Ä–∏–ø—Ç–æ–≤

### üì¶ –û—Å–Ω–æ–≤–Ω—ã–µ —É—Å—Ç–∞–Ω–æ–≤–æ—á–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã:
1. **01-prepare-system.sh** - –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Å–∏—Å—Ç–µ–º—ã –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
2. **02-install-prometheus.sh** - –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Prometheus —Å–µ—Ä–≤–µ—Ä–∞ –º–µ—Ç—Ä–∏–∫
3. **03-install-grafana.sh** - –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Grafana –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏
4. **04-install-alertmanager.sh** - –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Alertmanager –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∞–ª–µ—Ä—Ç–æ–≤
5. **05-install-exporters.sh** - –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —ç–∫—Å–ø–æ—Ä—Ç–µ—Ä–æ–≤ –º–µ—Ç—Ä–∏–∫ (Node, Nginx, PostgreSQL, Redis)
6. **06-configure-alerts.sh** - –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–∞–≤–∏–ª –∞–ª–µ—Ä—Ç–æ–≤ –∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
7. **07-create-dashboards.sh** - –°–æ–∑–¥–∞–Ω–∏–µ –¥–∞—à–±–æ—Ä–¥–æ–≤ Grafana
8. **08-optimize-monitoring.sh** - –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
9. **09-setup-backup.sh** - –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–∏—Å—Ç–µ–º—ã —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è
10. **10-final-check.sh** - –§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è

### üõ†Ô∏è –£—Ç–∏–ª–∏—Ç—ã –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏—è:
- **install-remote-agents.sh** - –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∞–≥–µ–Ω—Ç–æ–≤ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –Ω–∞ —É–¥–∞–ª–µ–Ω–Ω—ã–µ —Å–µ—Ä–≤–µ—Ä—ã
- **update-monitoring.sh** - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ —Å–∏—Å—Ç–µ–º—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
- **backup-monitoring.sh** - –°–æ–∑–¥–∞–Ω–∏–µ —Ä–µ–∑–µ—Ä–≤–Ω—ã—Ö –∫–æ–ø–∏–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π –∏ –¥–∞–Ω–Ω—ã—Ö
- **diagnose-monitoring.sh** - –ü–æ–ª–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —Å–∏—Å—Ç–µ–º—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

### üìã –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞:
- **install-monitoring.sh** - –ü–æ–ª–Ω–∞—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

## –ü–æ—ç—Ç–∞–ø–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞
```bash
# –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞
git clone https://github.com/cheptura/LMS_Drupal.git
cd LMS_Drupal/monitoring-installation
sudo chmod +x *.sh

# –ü–æ—ç—Ç–∞–ø–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ
sudo ./01-system-update.sh          # –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã
sudo ./02-install-prometheus.sh     # Prometheus —Å–µ—Ä–≤–µ—Ä
sudo ./03-install-grafana.sh        # Grafana –¥–∞—à–±–æ—Ä–¥—ã
sudo ./04-install-alertmanager.sh   # –°–∏—Å—Ç–µ–º–∞ –∞–ª–µ—Ä—Ç–æ–≤
sudo ./05-install-exporters.sh      # –≠–∫—Å–ø–æ—Ä—Ç–µ—Ä—ã –º–µ—Ç—Ä–∏–∫
sudo ./06-configure-monitoring.sh   # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
sudo ./07-setup-dashboards.sh       # –î–∞—à–±–æ—Ä–¥—ã
sudo ./08-configure-alerts.sh       # –ê–ª–µ—Ä—Ç—ã
sudo ./09-install-ssl.sh            # SSL –∑–∞—â–∏—Ç–∞
sudo ./10-final-setup.sh            # –§–∏–Ω–∞–ª–∏–∑–∞—Ü–∏—è
```

## –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ

### üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —Å–∏—Å—Ç–µ–º—ã
```bash
sudo ./diagnose-monitoring.sh  # –ü–æ–ª–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
systemctl status prometheus grafana-server alertmanager  # –°—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–∏—Å–æ–≤
```

### üåê –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —É–¥–∞–ª–µ–Ω–Ω—ã—Ö –∞–≥–µ–Ω—Ç–æ–≤
```bash
sudo ./install-remote-agents.sh  # –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–∞ —É–¥–∞–ª–µ–Ω–Ω—ã–µ —Å–µ—Ä–≤–µ—Ä—ã
# –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç SSH –∫–ª—é—á–∏ –∏ –ø–∞—Ä–æ–ª–∏
```

### üíæ –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ
```bash
sudo ./backup-monitoring.sh    # –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª–Ω–æ–≥–æ –±—ç–∫–∞–ø–∞
# –ë—ç–∫–∞–ø—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ /var/backups/monitoring/
```

### üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã
```bash
sudo ./update-monitoring.sh    # –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
```

### üìä –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã –ø–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏:
- **Grafana:** http://server-ip:3000 (admin/admin)
- **Prometheus:** http://server-ip:9090
- **Alertmanager:** http://server-ip:9093

## –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–∏—Å—Ç–µ–º—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

### üìà Prometheus (–ø–æ—Ä—Ç 9090)
- –°–±–æ—Ä –∏ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫
- –°–∏—Å—Ç–µ–º–∞ –∞–ª–µ—Ä—Ç–æ–≤
- PromQL –∑–∞–ø—Ä–æ—Å—ã
- Retention: 15 –¥–Ω–µ–π –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é

### üìä Grafana (–ø–æ—Ä—Ç 3000)
- –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –º–µ—Ç—Ä–∏–∫
- –î–∞—à–±–æ—Ä–¥—ã –∏ –ø–∞–Ω–µ–ª–∏
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏ —Ä–æ–ª–∏
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

### üö® Alertmanager (–ø–æ—Ä—Ç 9093)
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –∞–ª–µ—Ä—Ç–æ–≤
- –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- –ú–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ (email, Slack, Telegram)

### üì° –≠–∫—Å–ø–æ—Ä—Ç–µ—Ä—ã –º–µ—Ç—Ä–∏–∫:
- **Node Exporter** (9100) - —Å–∏—Å—Ç–µ–º–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏
- **Nginx Exporter** (9113) - –º–µ—Ç—Ä–∏–∫–∏ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–∞
- **PostgreSQL Exporter** (9187) - –º–µ—Ç—Ä–∏–∫–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- **Redis Exporter** (9121) - –º–µ—Ç—Ä–∏–∫–∏ –∫—ç—à–∞

## –°–∏—Å—Ç–µ–º–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è
- ‚úÖ **–û–°:** Ubuntu 24.04 LTS
- ‚úÖ **RAM:** –ú–∏–Ω–∏–º—É–º 4GB (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è 8GB)
- ‚úÖ **–î–∏—Å–∫:** 50GB —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –º–µ—Å—Ç–∞ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è 100GB)
- ‚úÖ **–°–µ—Ç—å:** –î–æ—Å—Ç—É–ø –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –ø–∞–∫–µ—Ç–æ–≤
- ‚úÖ **–ü—Ä–∞–≤–∞:** root –∏–ª–∏ sudo –¥–æ—Å—Ç—É–ø

## –°–µ—Ç–µ–≤—ã–µ –ø–æ—Ä—Ç—ã
- **3000** - Grafana (–≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å)
- **9090** - Prometheus (API –∏ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å)
- **9093** - Alertmanager (–≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å)
- **9100** - Node Exporter (–º–µ—Ç—Ä–∏–∫–∏ —Å–∏—Å—Ç–µ–º—ã)
- **9113** - Nginx Exporter (–º–µ—Ç—Ä–∏–∫–∏ Nginx)
- **9187** - PostgreSQL Exporter (–º–µ—Ç—Ä–∏–∫–∏ –ë–î)

## –ú–æ–Ω–∏—Ç–æ—Ä–∏—Ä—É–µ–º—ã–µ –º–µ—Ç—Ä–∏–∫–∏

### üñ•Ô∏è –°–∏—Å—Ç–µ–º–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏:
- –ó–∞–≥—Ä—É–∑–∫–∞ CPU –∏ –ø–∞–º—è—Ç—å
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥–∏—Å–∫–æ–≤
- –°–µ—Ç–µ–≤–æ–π —Ç—Ä–∞—Ñ–∏–∫
- –ü—Ä–æ—Ü–µ—Å—Å—ã –∏ —Å–µ—Ä–≤–∏—Å—ã

### üåê –í–µ–±-—Å–µ—Ä–≤–µ—Ä –º–µ—Ç—Ä–∏–∫–∏:
- HTTP –∑–∞–ø—Ä–æ—Å—ã –∏ –æ—Ç–≤–µ—Ç—ã
- –í—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞
- –ê–∫—Ç–∏–≤–Ω—ã–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
- –û—à–∏–±–∫–∏ 4xx/5xx

### üóÑÔ∏è –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –º–µ—Ç—Ä–∏–∫–∏:
- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î
- –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∑–∞–ø—Ä–æ—Å–æ–≤
- –†–∞–∑–º–µ—Ä —Ç–∞–±–ª–∏—Ü
- –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –∏ –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã

### üìö –ü—Ä–∏–ª–æ–∂–µ–Ω–∏—è (Moodle/Drupal):
- –î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —Å–µ—Ä–≤–∏—Å–æ–≤
- –í—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –æ–Ω–ª–∞–π–Ω
- –û—à–∏–±–∫–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

### üìß Email —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è:
```bash
# –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ Alertmanager
sudo nano /etc/alertmanager/alertmanager.yml
sudo systemctl restart alertmanager
```

### üí¨ Telegram —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è:
```bash
# –î–æ–±–∞–≤–ª–µ–Ω–∏–µ Telegram –±–æ—Ç–∞ –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
# –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –≤ —Ñ–∞–π–ª–µ /etc/alertmanager/telegram-config.yml
```

## –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∏ troubleshooting
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
sudo journalctl -u prometheus -f
sudo journalctl -u grafana-server -f
sudo journalctl -u alertmanager -f

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π
promtool check config /etc/prometheus/prometheus.yml
amtool check-config /etc/alertmanager/alertmanager.yml

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–æ–≤
sudo systemctl restart prometheus
sudo systemctl restart grafana-server
sudo systemctl restart alertmanager
```

## –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ
- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —Å–µ—Ä–≤–µ—Ä–æ–≤ —á–µ—Ä–µ–∑ `install-remote-agents.sh`
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ federation –¥–ª—è –±–æ–ª—å—à–∏—Ö –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä
- –î–ª–∏—Ç–µ–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫ —á–µ—Ä–µ–∑ Thanos (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- **Postgres Exporter**: 0.13+ (–ë–î –º–µ—Ç—Ä–∏–∫–∏)

### –°–∏—Å—Ç–µ–º–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è
- **CPU**: 2+ cores
- **RAM**: 4GB (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è 8GB)
- **Storage**: 100GB+ SSD
- **Network**: 1Gbps

## üìä –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

### üîç Prometheus
- **–ü–æ—Ä—Ç**: 9090
- **URL**: http://monitoring.omuzgorpro.tj:9090
- **–§—É–Ω–∫—Ü–∏–∏**: –°–±–æ—Ä –º–µ—Ç—Ä–∏–∫, –ø—Ä–∞–≤–∏–ª–∞ –∞–ª–µ—Ä—Ç–æ–≤
- **–•—Ä–∞–Ω–µ–Ω–∏–µ**: 30 –¥–Ω–µ–π –¥–∞–Ω–Ω—ã—Ö

### üìà Grafana
- **–ü–æ—Ä—Ç**: 3000
- **URL**: http://monitoring.omuzgorpro.tj:3000
- **–î–∞–Ω–Ω—ã–µ**: admin / RTTIMonitor2024!
- **–§—É–Ω–∫—Ü–∏–∏**: –î–∞—à–±–æ—Ä–¥—ã, –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è

### üö® Alertmanager
- **–ü–æ—Ä—Ç**: 9093
- **URL**: http://monitoring.omuzgorpro.tj:9093
- **–§—É–Ω–∫—Ü–∏–∏**: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–ª–µ—Ä—Ç–∞–º–∏, —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

### üì° Exporters
- **Node Exporter**: 9100 (—Å–∏—Å—Ç–µ–º–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏)
- **Nginx Exporter**: 9113 (–≤–µ–±-—Å–µ—Ä–≤–µ—Ä)
- **Postgres Exporter**: 9187 (–±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö)
- **Redis Exporter**: 9121 (–∫—ç—à)

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–µ—Ä–≤–µ—Ä–æ–≤

### üéì Moodle —Å–µ—Ä–≤–µ—Ä (omuzgorpro.tj) - –¶–ï–ù–¢–†–ê–õ–¨–ù–´–ô –ú–û–ù–ò–¢–û–†–ò–ù–ì
- –°–∏—Å—Ç–µ–º–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã (CPU, RAM, Disk)
- Nginx –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- PHP-FPM –º–µ—Ç—Ä–∏–∫–∏
- PostgreSQL —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
- Redis —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
- Moodle —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏
- **Prometheus —Å–µ—Ä–≤–µ—Ä**: —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∑–¥–µ—Å—å
- **Grafana –¥–∞—à–±–æ—Ä–¥—ã**: —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –∑–¥–µ—Å—å
- **Alertmanager**: —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∑–¥–µ—Å—å

### üìö Drupal —Å–µ—Ä–≤–µ—Ä (storage.omuzgorpro.tj) - –£–î–ê–õ–ï–ù–ù–´–ô –ú–û–ù–ò–¢–û–†–ò–ù–ì
- –°–∏—Å—Ç–µ–º–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã
- Nginx –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- **–¢–æ–ª—å–∫–æ —ç–∫—Å–ø–æ—Ä—Ç–µ—Ä—ã –º–µ—Ç—Ä–∏–∫**: –¥–∞–Ω–Ω—ã–µ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –Ω–∞ —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π —Å–µ—Ä–≤–µ—Ä
- PHP-FPM –º–µ—Ç—Ä–∏–∫–∏
- PostgreSQL —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
- Drupal —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏
- –§–∞–π–ª–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞

## üìà –î–∞—à–±–æ—Ä–¥—ã

### –ü—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –¥–∞—à–±–æ—Ä–¥—ã
1. **System Overview** - –û–±—â–∏–π –æ–±–∑–æ—Ä —Å–∏—Å—Ç–µ–º
2. **Moodle LMS** - –°–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ Moodle
3. **Drupal Library** - –ú–µ—Ç—Ä–∏–∫–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏
4. **Database Performance** - –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ë–î
5. **Web Server Stats** - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–æ–≤
6. **Infrastructure Health** - –ó–¥–æ—Ä–æ–≤—å–µ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã

### –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –¥–∞—à–±–æ—Ä–¥—ã
```bash
# –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –¥–∞—à–±–æ—Ä–¥–∞
./create-dashboard.sh "Dashboard Name"

# –ò–º–ø–æ—Ä—Ç –¥–∞—à–±–æ—Ä–¥–∞ –∏–∑ —Ñ–∞–π–ª–∞
./import-dashboard.sh dashboard.json

# –≠–∫—Å–ø–æ—Ä—Ç –¥–∞—à–±–æ—Ä–¥–∞
./export-dashboard.sh "Dashboard Name"
```

## üö® –ê–ª–µ—Ä—Ç—ã –∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

### –ü—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –∞–ª–µ—Ä—Ç—ã
- **High CPU Usage** (>80% –Ω–∞ 5 –º–∏–Ω—É—Ç)
- **High Memory Usage** (>90% –Ω–∞ 5 –º–∏–Ω—É—Ç)
- **Disk Space Low** (<10% —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –º–µ—Å—Ç–∞)
- **Service Down** (Nginx, PostgreSQL, Redis)
- **Database Connections High** (>80% –æ—Ç –ª–∏–º–∏—Ç–∞)
- **SSL Certificate Expiry** (<30 –¥–Ω–µ–π)

### –ö–∞–Ω–∞–ª—ã —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
```bash
# Email —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
./setup-email-alerts.sh admin@omuzgorpro.tj

# Telegram —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
./setup-telegram-alerts.sh

# Slack —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
./setup-slack-alerts.sh
```

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏

```
/opt/prometheus/              # Prometheus —Å–µ—Ä–≤–µ—Ä
/opt/grafana/                 # Grafana
/opt/alertmanager/            # Alertmanager
/etc/prometheus/              # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
/var/lib/prometheus/          # –î–∞–Ω–Ω—ã–µ –º–µ—Ç—Ä–∏–∫
/var/lib/grafana/             # –î–∞–Ω–Ω—ã–µ Grafana
/root/monitoring-credentials.txt  # –î–∞–Ω–Ω—ã–µ –¥–æ—Å—Ç—É–ø–∞
```

## üîë –î–∞–Ω–Ω—ã–µ –¥–æ—Å—Ç—É–ø–∞

–ü–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –¥–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—Ç—Å—è –≤:
- `/root/monitoring-credentials.txt` - –í—Å–µ –¥–∞–Ω–Ω—ã–µ –¥–æ—Å—Ç—É–ø–∞

**–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é:**
- **Grafana**: admin / RTTIMonitor2024!
- **Prometheus**: –±–µ–∑ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- **Alertmanager**: –±–µ–∑ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–ª—É–∂–±
systemctl status prometheus
systemctl status grafana-server
systemctl status alertmanager
systemctl status node_exporter

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Ä—Ç–æ–≤
netstat -tlnp | grep -E "(9090|3000|9093|9100)"

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–µ—Ç—Ä–∏–∫
curl http://localhost:9090/api/v1/targets
```

## üîß –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

### Prometheus
```bash
sudo systemctl restart prometheus
sudo systemctl reload prometheus
promtool check config /etc/prometheus/prometheus.yml
```

### Grafana
```bash
sudo systemctl restart grafana-server
sudo grafana-cli plugins list
sudo grafana-cli plugins install grafana-piechart-panel
```

### Alertmanager
```bash
sudo systemctl restart alertmanager
amtool check-config /etc/alertmanager/alertmanager.yml
```

## üìä –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∞–≥–µ–Ω—Ç–æ–≤ –Ω–∞ –Ω–æ–≤–æ–º —Å–µ—Ä–≤–µ—Ä–µ
./install-remote-agents.sh 192.168.1.100

# –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é Prometheus
./add-server.sh "server-name" "192.168.1.100"

# –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π
sudo systemctl reload prometheus
```

## üîç –ó–∞–ø—Ä–æ—Å—ã –∏ –º–µ—Ç—Ä–∏–∫–∏

### –ü–æ–ª–µ–∑–Ω—ã–µ PromQL –∑–∞–ø—Ä–æ—Å—ã
```promql
# –ó–∞–≥—Ä—É–∑–∫–∞ CPU
100 - (avg by (instance) (irate(node_cpu_seconds_total{mode="idle"}[5m])) * 100)

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏
(1 - (node_memory_MemAvailable_bytes / node_memory_MemTotal_bytes)) * 100

# –ú–µ—Å—Ç–æ –Ω–∞ –¥–∏—Å–∫–µ
100 - ((node_filesystem_avail_bytes * 100) / node_filesystem_size_bytes)

# –ü–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î
pg_stat_database_numbackends

# Nginx –∑–∞–ø—Ä–æ—Å—ã
rate(nginx_http_requests_total[5m])
```

## üÜò –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã
1. **Prometheus –Ω–µ —Å–æ–±–∏—Ä–∞–µ—Ç –º–µ—Ç—Ä–∏–∫–∏** - –ø—Ä–æ–≤–µ—Ä—å—Ç–µ targets
2. **Grafana –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ** - –ø—Ä–æ–≤–µ—Ä—å—Ç–µ data source
3. **–ê–ª–µ—Ä—Ç—ã –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç** - –ø—Ä–æ–≤–µ—Ä—å—Ç–µ Alertmanager –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
4. **–í—ã—Å–æ–∫–æ–µ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ –º–µ—Å—Ç–∞** - –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ retention policy

### –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞
```bash
./diagnose-monitoring.sh      # –ü–æ–ª–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞
./check-metrics.sh           # –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–µ—Ç—Ä–∏–∫
./test-alerts.sh            # –¢–µ—Å—Ç –∞–ª–µ—Ä—Ç–æ–≤
```

### –û—á–∏—Å—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö
```bash
./cleanup-old-metrics.sh     # –û—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö –º–µ—Ç—Ä–∏–∫
./rotate-logs.sh            # –†–æ—Ç–∞—Ü–∏—è –ª–æ–≥–æ–≤
```

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –ó–∞—â–∏—Ç–∞ –¥–æ—Å—Ç—É–ø–∞
```bash
./setup-auth.sh             # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
./setup-ssl-monitoring.sh   # SSL –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
./configure-firewall.sh     # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ñ–∞–π—Ä–≤–æ–ª–∞
```

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

- **GitHub**: https://github.com/cheptura/LMS_Drupal/issues
- **Email**: admin@omuzgorpro.tj
- **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**: [RTTI LMS Wiki](https://github.com/cheptura/LMS_Drupal/wiki)
- **Prometheus**: https://prometheus.io/docs/
- **Grafana**: https://grafana.com/docs/

---

**–í–µ—Ä—Å–∏—è**: 1.0  
**–î–∞—Ç–∞**: –°–µ–Ω—Ç—è–±—Ä—å 2025  
**–ê–≤—Ç–æ—Ä**: RTTI Development Team

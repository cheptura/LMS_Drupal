# Moodle Installation Scripts

## –û–ø–∏—Å–∞–Ω–∏–µ
–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ Moodle 5.0+ –Ω–∞ Ubuntu 24.04 LTS —Å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è–º–∏ –¥–ª—è RTTI.

## üöÄ QUICK_INSTALL
```bash
# –ë—ã—Å—Ç—Ä–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ (–æ–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π)
git clone https://github.com/cheptura/LMS_Drupal.git
cd LMS_Drupal/moodle-installation
sudo chmod +x install-all.sh && sudo ./install-all.sh
```

## –°–æ—Å—Ç–∞–≤ —Å–∫—Ä–∏–ø—Ç–æ–≤

### üì¶ –û—Å–Ω–æ–≤–Ω—ã–µ —É—Å—Ç–∞–Ω–æ–≤–æ—á–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã:
1. **01-system-update.sh** - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã –∏ –±–∞–∑–æ–≤—ã–µ –ø–∞–∫–µ—Ç—ã
2. **02-install-nginx.sh** - –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ Nginx –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–∞
3. **03-install-php.sh** - –£—Å—Ç–∞–Ω–æ–≤–∫–∞ PHP 8.3 —Å –º–æ–¥—É–ª—è–º–∏ –¥–ª—è Moodle
4. **04-install-postgresql.sh** - –£—Å—Ç–∞–Ω–æ–≤–∫–∞ PostgreSQL 16 –°–£–ë–î
5. **05-configure-database.sh** - –°–æ–∑–¥–∞–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
6. **06-download-moodle.sh** - –ó–∞–≥—Ä—É–∑–∫–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–π –≤–µ—Ä—Å–∏–∏ Moodle 5.0
7. **07-configure-moodle.sh** - –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ config.php
8. **08-configure-nginx-site.sh** - –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ —Ö–æ—Å—Ç–∞
9. **09-install-ssl.sh** - –£—Å—Ç–∞–Ω–æ–≤–∫–∞ SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤ Let's Encrypt
10. **10-final-setup.sh** - –§–∏–Ω–∞–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è

### ÔøΩÔ∏è –£—Ç–∏–ª–∏—Ç—ã –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏—è:
- **update-moodle.sh** - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ Moodle –¥–æ –Ω–æ–≤—ã—Ö –≤–µ—Ä—Å–∏–π
- **backup-moodle.sh** - –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª–Ω—ã—Ö —Ä–µ–∑–µ—Ä–≤–Ω—ã—Ö –∫–æ–ø–∏–π
- **restore-moodle.sh** - –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ —Ä–µ–∑–µ—Ä–≤–Ω—ã—Ö –∫–æ–ø–∏–π
- **diagnose-moodle.sh** - –ü–æ–ª–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —Å–∏—Å—Ç–µ–º—ã Moodle

### üìã –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞:
- **install-all.sh** - –ü–æ–ª–Ω–∞—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

## –ü–æ—ç—Ç–∞–ø–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞
```bash
# –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞
git clone https://github.com/cheptura/LMS_Drupal.git
cd LMS_Drupal/moodle-installation
sudo chmod +x *.sh

# –ü–æ—ç—Ç–∞–ø–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ
sudo ./01-system-update.sh     # –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã
sudo ./02-install-nginx.sh     # –í–µ–±-—Å–µ—Ä–≤–µ—Ä
sudo ./03-install-php.sh       # PHP –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞
sudo ./04-install-postgresql.sh # –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
sudo ./05-configure-database.sh # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ë–î
sudo ./06-download-moodle.sh   # –ó–∞–≥—Ä—É–∑–∫–∞ Moodle
sudo ./07-configure-moodle.sh  # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
sudo ./08-configure-nginx-site.sh # –í–µ–±-—Å–µ—Ä–≤–µ—Ä
sudo ./09-install-ssl.sh       # SSL –∑–∞—â–∏—Ç–∞
sudo ./10-final-setup.sh       # –§–∏–Ω–∞–ª–∏–∑–∞—Ü–∏—è
```

## –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ

### üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —Å–∏—Å—Ç–µ–º—ã
```bash
sudo ./diagnose-moodle.sh  # –ü–æ–ª–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
systemctl status nginx postgresql php8.3-fpm  # –°—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–∏—Å–æ–≤
```

### ÔøΩ –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ
```bash
sudo ./backup-moodle.sh    # –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª–Ω–æ–≥–æ –±—ç–∫–∞–ø–∞
# –ë—ç–∫–∞–ø—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ /var/backups/moodle/
```

### üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã
```bash
sudo ./update-moodle.sh    # –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–æ –Ω–æ–≤–æ–π –≤–µ—Ä—Å–∏–∏ Moodle
```

### üîß –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ
```bash
sudo ./restore-moodle.sh /path/to/backup.tar.gz  # –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ –±—ç–∫–∞–ø–∞
```

## –°–∏—Å—Ç–µ–º–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è
- ‚úÖ **–û–°:** Ubuntu 24.04 LTS
- ‚úÖ **RAM:** –ú–∏–Ω–∏–º—É–º 4GB (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è 8GB)
- ‚úÖ **–î–∏—Å–∫:** 20GB —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –º–µ—Å—Ç–∞ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è 50GB)
- ‚úÖ **–°–µ—Ç—å:** –î–æ—Å—Ç—É–ø –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –ø–∞–∫–µ—Ç–æ–≤
- ‚úÖ **–ü—Ä–∞–≤–∞:** root –∏–ª–∏ sudo –¥–æ—Å—Ç—É–ø

## –°–µ—Ç–µ–≤—ã–µ –ø–æ—Ä—Ç—ã
- **80** - HTTP (–≤–µ–±-—Å–µ—Ä–≤–µ—Ä)
- **443** - HTTPS (–∑–∞—â–∏—â–µ–Ω–Ω—ã–π –≤–µ–±-—Å–µ—Ä–≤–µ—Ä)
- **5432** - PostgreSQL (–±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö)
- **9000** - PHP-FPM (–≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π)

## –î–æ—Å—Ç—É–ø –∫ —Å–∏—Å—Ç–µ–º–µ

### üåê –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å Moodle:
- **HTTP:** http://–≤–∞—à-ip-–∞–¥—Ä–µ—Å
- **HTTPS:** https://–≤–∞—à-–¥–æ–º–µ–Ω (–ø–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ SSL)

### ÔøΩ –£—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:
- –î–∞–Ω–Ω—ã–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –≤—ã–≤–æ–¥—è—Ç—Å—è –≤ –∫–æ–Ω—Ü–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏
- –°–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ —Ñ–∞–π–ª–µ `/var/log/moodle-install.log`

### ÔøΩ –í–∞–∂–Ω—ã–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏:
- **–ö–æ–¥ Moodle:** `/var/www/html/moodle`
- **–î–∞–Ω–Ω—ã–µ:** `/var/moodledata`
- **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:** `/var/www/html/moodle/config.php`
- **–õ–æ–≥–∏ Nginx:** `/var/log/nginx/`
- **–õ–æ–≥–∏ PHP:** `/var/log/php8.3-fpm.log`

## –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∏ troubleshooting
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤ –ø—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö
sudo tail -f /var/log/nginx/error.log
sudo tail -f /var/log/php8.3-fpm.log
sudo journalctl -u nginx -f

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–æ–≤
sudo systemctl restart nginx
sudo systemctl restart php8.3-fpm
sudo systemctl restart postgresql
```
